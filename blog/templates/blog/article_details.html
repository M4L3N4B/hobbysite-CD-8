{% extends "blog/layout.html" %}

{% block body %}
    <div class="article-details">
        <ul class="article-details-list">
            <li>
                <div class="article-details-header">
                    <h1>{{ object.title }}</h1>
                    <div class="article-timestamps">
                        <p>Created on: {{ object.created_on }}</p>
                        <p>Updated on: {{ object.updated_on }}</p>
                    </div>
                </div>

                {% if object.header_image %}
                    <img src="{{ object.header_image.url }}" alt="Header Image" style="width:100%; max-height:400px; object-fit:cover; border-radius:10px; margin-bottom:10px;">
                {% endif %}

                <p>Category: 
                    {% if object.category %}
                        {{ object.category.name }}
                    {% else %}
                        Others
                    {% endif %}
                </p>
                <p class="article-content">Entry: {{ object.entry }}</p>

                {% if user == object.author.user %}
                    <p><a href="{% url 'article_update' object.pk %}">Edit Article</a></p>
                {% endif %}
                <p><a href="{% url 'blog_list' %}">Back to Article List</a></p>

                <h3>More from this author:</h3>
                <ul>
                    {% for related_article in related_articles %}
                        {% if related_article.pk != object.pk %}
                            <li><a href="{% url 'article_details' related_article.pk %}">{{ related_article.title }}</a></li>
                        {% endif %}
                    {% empty %}
                        <li>No other articles by this author.</li>
                    {% endfor %}
                </ul>

                {% if user.is_authenticated %}
                    <h3>Leave a Comment</h3>
                    <form method="post">
                        {% csrf_token %}
                        {{ comment_form.as_p }}
                        <button type="submit">Submit Comment</button>
                    </form>
                {% endif %}

                <h3>Comments</h3>
                <ul>
                    {% for comment in comments %}
                        <li>
                            <strong>{{ comment.author }}</strong>: {{ comment.entry }} <br>
                            <small>On {{ comment.created_on }}</small>
                        </li>
                    {% empty %}
                        <li>No comments yet.</li>
                    {% endfor %}
                </ul>
            </li>
        </ul>
    </div>
{% endblock %}
