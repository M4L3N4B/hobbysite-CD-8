{% extends "blog/layout.html" %}
{% load static %}

{% block body %}
<div class="article-details">
    <ul class="article-details-list">
        <li>
            <!-- Title -->
            <div class="article-details-header">
                <h1>{{ article.title }}</h1>
                <div class="article-timestamps">
                    <p>Created on: {{ article.created_on }}</p>
                    <p>Updated on: {{ article.updated_on }}</p>
                </div>
            </div>

            <!-- Header Image -->
            {% if article.header_image %}
                <img src="{{ article.header_image.url }}">
            {% endif %}

            <!-- Category -->
            <p>Category: {{ article.category.name|default:"Others" }}</p>

            <!-- Entry -->
            <p class="article-content">{{ article.entry }}</p>

            <!-- Edit link for owner -->
            {% if user.is_authenticated and user.profile == article.author %}
                <p><a href="{% url 'article_update' article.pk %}">Edit Article</a></p>
            {% endif %}

            <!-- Back to list -->
            <p><a href="{% url 'blog_list' %}">Back to Article List</a></p>

            <!-- More from author -->
            <h3>More from this author:</h3>
            <ul>
                {% for related_article in related_articles %}
                    <li><a href="{% url 'article_details' related_article.pk %}">{{ related_article.title }}</a></li>
                {% empty %}
                    <li>No other articles by this author.</li>
                {% endfor %}
            </ul>

            <!-- Comment form -->
            {% if user.is_authenticated %}
                <h3>Leave a Comment</h3>
                <form method="post">
                    {% csrf_token %}
                    {{ comment_form.as_p }}
                    <button type="submit">Submit Comment</button>
                </form>
            {% endif %}

            <!-- Comments section -->
            <h3>Comments</h3>
            <ul>
                {% for comment in comments %}
                    <li>
                        <strong>{{ comment.author.user.username }}</strong>: {{ comment.entry }} <br>
                        <small>On {{ comment.created_on }}</small>
                    </li>
                {% empty %}
                    <li>No comments yet.</li>
                {% endfor %}
            </ul>
        </li>
    </ul>
</div>
{% endblock %}
